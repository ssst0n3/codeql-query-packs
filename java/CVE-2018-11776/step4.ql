/**
 * @name Step 4: Finding all method call to getMethod, getNamespace, getAction under ActionProxy
 */

import java

from MethodAccess ma, Method m
where ma.getMethod()=m and
    m.getDeclaringType().hasQualifiedName("com.opensymphony.xwork2", "ActionProxy") 
    and (
        m.getName()="getMethod" or
        m.getName()="getNamespace" or 
        m.getName()="getAction"
    )
select ma, m, m.getDeclaringType()
