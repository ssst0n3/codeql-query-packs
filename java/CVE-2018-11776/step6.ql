/**
 * @name Step 6: rewrite step5 to predicate
 */

import java

predicate isActionProxySource(MethodAccess ma) {
    exists(Method m, Method methodOverride |  m.getDeclaringType().hasQualifiedName("com.opensymphony.xwork2", "ActionProxy") 
    and methodOverride.overrides*(m)
    and ma.getMethod()=methodOverride
    and (
        m.getName()="getMethod" or
        m.getName()="getNamespace" or 
        m.getName()="getAction"
    ))
}

from MethodAccess ma
where isActionProxySource(ma)
select ma, ma.getLocation()
