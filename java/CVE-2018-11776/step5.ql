/**
 * @name Step 5: Finding all method call to getMethod, getNamespace, getAction and their's override under ActionProxy
 */

import java

from MethodAccess ma, Method m, Method methodOverride
where m.getDeclaringType().hasQualifiedName("com.opensymphony.xwork2", "ActionProxy") 
    and methodOverride.overrides*(m)
    and ma.getMethod()=methodOverride
    and (
        m.getName()="getMethod" or
        m.getName()="getNamespace" or 
        m.getName()="getAction"
    )
select ma, m.getLocation(), methodOverride.getLocation()
